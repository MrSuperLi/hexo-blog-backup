layout: post
title: "提高访问性能与用户体验"
date: 2018-5-27 14:04
comments: true
tags: 
	- 性能
	- 用户体验
---

如何设计/优化一个访问量比较大的稳定的web站点。

<!--more-->

### 一、 性能

- 1. 纵向
    - 1.1 动态内容静态化
    - 1.2 减少不必要请求，使用雪碧图。每次请求都是可能失败的
    - 1.3 客户端缓存
    - 1.4 CDN
    - 1.5 数据库优化。索引优化，读写分离，SQL优化
    - 1.6 服务端缓存，Redis/Memcache
    - 1.7 防盗链接，控制大文件上下载
- 2. 横向
    - 2.1 分布式集群
    - 2.2 负载均衡

### 二、用户体验
> 这一点只是给出自身项目中遇到过的

- 1. 懒加载。不仅是客户端图片的懒加载；而且服务端不要一次性加载一大堆无用的东西，要尽量精简
- 2. 减少http请求。因为每次请求都有可能失败，尽可能一次性解决
- 3. 使用错误重试机制。在测试时候不会有错误情况，但是在用户访问会有各种各样的问题，因此做好错误重试。比如用户登录，这个请求关乎用户留存的，必须使用重试机制
- 4. 如果重试还是不行，就需要上报错误日志了。ELK(ElasticSearch, Logstash, Kibana)搭建实时日志分析平台
    - 4.1 客户端请求错误日志
    - 4.2 客户端JS运行错误日志 window.onerror
    - 4.3 服务端的错误日志。比如：Laravel的App\Exceptions\Handler::report就可以全局上报
- 5. 预警。有了错误日志，就需要对日志汇总并且通过邮箱/微信/短信等方式进行预警